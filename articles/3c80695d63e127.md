---
title: "Irisï¼ˆGoè¨€èªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼‰ã®ä½¿ã„æ–¹ã‚’æœ€é€Ÿã§ãƒã‚¹ã‚¿ãƒ¼ã™ã‚‹"
emoji: "ğŸ¦¸ğŸ¼â€â™‚ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Go", "golang", "Iris", "iris"]
published: true
---

# åˆã‚ã«

https://www.iris-go.com


![Irisãƒ­ã‚´](/images/go-iris-sample/iris_logo.png)
*Iris ã®ãƒã‚¹ã‚³ãƒƒãƒˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚‰ã—ã„ï¼ˆå¯æ„›ã„ï¼‰*


:::message alert
5å¹´ã»ã©å‰ã«å®Ÿéš›ã«èµ·ããŸã“ã¨ã§ã™ãŒï¼ŒIris ã¨ã„ã†ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¯éå»ã«ä½œè€…ã®ï¼Œãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚„ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°ã€Contributorsã€Issueç­‰ã®æ‰±ã„æ–¹ãŒæ‚ªè³ªã§ã‚ã£ãŸãŒã‚†ãˆã«awesome-goãªã©ã«ã‚‚æ²è¼‰ã‚’æ‹’å¦ã•ã‚ŒãŸã“ã¨ã‚‚ã‚ã‚Šã¾ã™ï¼
ã§ã™ã®ã§ã€ä½¿ç”¨ã®éš›ã«ã¯ï¼Œä¸€äººä¸€äººãã†ã„ã£ãŸç‚¹ã‚’ååˆ†ã«è€ƒæ…®ãƒ»åˆ¤æ–­ã—ãŸä¸Šã§ã”ä½¿ç”¨ãã ã•ã„
:::


## Irisï¼ˆã‚¢ã‚¤ãƒªã‚¹ï¼‰ã¨ã¯ä½•ã‹

**Iris ã¯Goè¨€èªã§æ›¸ã‹ã‚ŒãŸWebãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ï¼**

[å…¬å¼ã‚µã‚¤ãƒˆ](https://iris-go.com)ã§ã‚‚ã€æœ€é€Ÿã®Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã€ã‚’è¬³ã£ã¦ãŠã‚Šï¼ŒWebã‚µãƒ¼ãƒãƒ»ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ»ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ãªã©æ§˜ã€…ãªç’°å¢ƒã‚’å•ã‚ãšè¶…é«˜é€Ÿã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç™ºæ®ã—ã¾ã™

ãã®ä»–ã®ç‰¹å¾´ã¨ã—ã¦ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãƒ»MVCãƒ¢ãƒ‡ãƒ«ãªã©ãŒæŒ™ã’ã‚‰ã‚Œã¾ã™
ã¾ãŸï¼ŒGoè¨€èªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ä¸­ã§ã‚‚åœ§å€’çš„ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé‡ã‚’å®Ÿç¾ã—ã¦ãŠã‚Šï¼Œæƒ…å ±é‡ã®å¤šã•ã‹ã‚‰æœ€ã‚‚åŠ¹ç‡è‰¯ãå­¦ç¿’ãŒå‡ºæ¥ã‚‹ã¨ã‚‚ã„ãˆã¾ã™ï¼

å®Ÿéš›ã«ï¼Œ[Goè¨€èªã®webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’å°‚é–€ã«ã•ã¾ã–ã¾ãªæ¯”è¼ƒã‚’è¡Œãªã£ã¦ã„ã‚‹ãƒªãƒã‚¸ãƒˆãƒª](https://github.com/speedwheel/awesome-go-web-frameworks/blob/master/README.md) ã‚’å‚è€ƒã«ä»–ã®Goãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ¯”è¼ƒã—ã¦ã¿ã¾ã™


### é«˜é€Ÿæ€§

Iris ã®æœ€å¤§ã®ç‰¹å¾´ã¯ã€æœ€é€Ÿã®Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚‹ã€ã¨ã„ã†ã“ã¨ã§ã™

ä»–ã®ã©ã®HTTP/2ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚ˆã‚Šã‚‚é«˜é€Ÿã«å‹•ä½œã—ï¼Œæ•°å¤šãã®ç«¶åˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨1ç§’ã‚ãŸã‚Šã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°ãƒ»è»¢é€ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®é–“ã®æ™‚é–“ã®æ¸¬å®šï¼ˆãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼‰ã‚’å®Ÿè¡Œã—ãŸã¨ã“ã‚ä¸€ç•ªå„ªç§€ãªæ•°å€¤ã‚’å©ãå‡ºã—ã¦ã„ã¾ã™

| Name    | Language   | Reqs/sec | Latency  | Throughput | Time To Complete |
|:--------|:-----------|:--------:|:--------:|:----------:|:----------------:|
| Iris    | Go         |  150430  | 826.05us |  41.25MB   |      1.33s       |
| Chi     | Go         |  146274  |  0.85ms  |  39.32MB   |      1.37s       |
| Gin     | Go         |  141664  |  0.88ms  |  38.74MB   |      1.41s       |
| Echo    | Go         |  138915  |  0.90ms  |  38.15MB   |      1.44s       |
| Kestrel | C#         |  136935  |  0.91ms  |  39.79MB   |      1.47s       |
| Martini | Go         |  128590  |  0.97ms  |  34.57MB   |      1.56s       |
| Buffalo | Go         |  58954   |  2.12ms  |  16.18MB   |      3.40s       |
| Koa     | JavaScript |  50948   |  2.61ms  |  14.15MB   |      4.19s       |
| Express | JavaScript |  38451   |  3.24ms  |  13.77MB   |      5.21s       |


### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»æƒ…å ±é‡

| Name    | Examples | Reference                                             | Real time support                                    |
|---------|:--------:|-------------------------------------------------------|------------------------------------------------------|
| Iris    |    92    | https://github.com/kataras/iris/tree/master/_examples | [rocket chat](https://chat.iris-go.com)              |
| Beego   |    49    | https://beego.me/docs                                 |                                                      |
| Echo    |    20    | https://echo.labstack.com/cookbook/hello-world        |                                                      |
| Gin     |    15    | https://github.com/gin-gonic/gin/tree/master/examples | [gitter](https://gitter.im/gin-gonic/gin)            |
| Revel   |    6     | http://revel.github.io/examples/index.html            | [gitter](https://gitter.im/revel/community)          |
| Buffalo |    6     | https://gobuffalo.io/docs/installation                | [slack](https://gophers.slack.com/messages/buffalo/) |

Gin ã‚„ Echo ãªã©ã®ä»–ã®ç«¶åˆGoãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ¯”ã¹ã¦ï¼ŒIris ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é‡ã¯ã‚„ã¯ã‚Šå¤šã„ã§ã™ã­
ã“ã‚Œã¯ç§ã‚‚å‹‰å¼·ã—ãªãŒã‚‰éå¸¸ã«æ„Ÿã˜ã¾ã—ãŸ


### æ©Ÿèƒ½æ€§

| Name                                                                                                                                     |          Iris          |          Beego           |           Revel           |           Echo            |            Gin            |          Buffalo          |
|:-----------------------------------------------------------------------------------------------------------------------------------------|:----------------------:|:------------------------:|:-------------------------:|:-------------------------:|:-------------------------:|:-------------------------:|
| Router: Named Path Parameters & Wildcard[*](#router-named-path-parameters--wildcard)                                                     | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)â€»  |
| Router: Regex[*](#router-regex)                                                                                                          | ![](/images/green.png) |  ![](/images/green.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |  ![](/images/green.png)â€»  |
| Router: Grouping[*](#router-grouping)                                                                                                    | ![](/images/green.png) |            â“             |             â“             |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)â€»  |
| Router: All the above Mixed Without Conflict[*](#all-the-above-mixed-without-conflict)                                                   | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Router: Custom HTTP Errors[*](#router-custom-http-errors)                                                                                | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   | ![](/images/running.png)  |  ![](/images/green.png)   |
| 100% compatible with net/http[*](#100-compatible-with-nethttp)                                                                           | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  |             â“             |  ![](/images/green.png)   |  ![](/images/green.png)   |
| Middleware ecosystem[*](#middleware-ecosystem)                                                                                           | ![](/images/green.png) |  ![](/images/green.png)  | ![](/images/running.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   | ![](/images/running.png)  |
| Sinatra-like API[*](#sinatra-like-api)                                                                                                   | ![](/images/green.png) |  ![](/images/green.png)  | ![](/images/running.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   | ![](/images/running.png)  |
| Server: Automatic HTTPS[*](#server-automatic-https)                                                                                      | ![](/images/green.png) |            â“             | ![](/images/running.png)  |  ![](/images/green.png)   | ![](/images/running.png)  | ![](/images/running.png)  |
| Server: Gracefully Shutdown[*](#server-gracefully-shutdown)                                                                              | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Server: Multi Listeners[*](#server-multi-listeners)                                                                                      | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Full HTTP/2[*](#full-http2)                                                                                                              | ![](/images/green.png) |            â“             |             â“             |  ![](/images/green.png)   |         standard          |         standard          |
| Subdomains[*](#subdomains)                                                                                                               | ![](/images/green.png) |        secondary         |         secondary         |         secondary         |         secondary         |         secondary         |
| Sessions[*](#sessions)                                                                                                                   | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   | ![](/images/running.png)  | ![](/images/running.png)  |         secondary         |
| Websockets[*](#websockets)                                                                                                               | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| View (aka Templates) Embedded Into App[*](#view-aka-templates-embedded-into-app)                                                         | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| View Engine: STD[*](#view-engine-std)                                                                                                    | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)   | ![](/images/running.png)  |
| View Engine: Pug[*](#view-engine-pug)                                                                                                    | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| View Engine: Django[*](#view-engine-django)                                                                                              | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| View Engine: Handlebars[*](#view-engine-handlebars)                                                                                      | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| View Engine: Amber[*](#view-engine-amber)                                                                                                | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Renderer: Markdown, JSON, JSONP, XML...[*](#renderer-markdown-json-jsonp-xml)                                                            | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)   | ![](/images/running.png)  |
| MVC[*](#mvc)                                                                                                                             | ![](/images/green.png) | ![](/images/green.png)â€»  |         generator         | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Caching[*](#catching)                                                                                                                    | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| File Server[*](#file-server)                                                                                                             | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)   |  ![](/images/green.png)   |
| File Server: Embedded Into App[*](#file-server-embedded-into-app)                                                                        | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Response can be Modified Many times through lifecycle before sent[*](#response-can-be-modified-many-times-through-lifecycle-before-sent) | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Gzip[*](#gzip)                                                                                                                           | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |        middleware         |        middleware         |        middleware         |
| Testing Framework[*](#testing-framework)                                                                                                 | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Typescript Transpiler[*](#typescript-transpiler)                                                                                         | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Online Editor[*](#online-editor)                                                                                                         | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Logging System[*](#logging-system)                                                                                                       | ![](/images/green.png) |  ![](/images/green.png)  |  ![](/images/green.png)   |  ![](/images/green.png)â€»  |  ![](/images/green.png)â€»  | ![](/images/running.png)  |
| Maintenance & Auto-Updates[*](#maintenance--auto-updates)                                                                                | ![](/images/green.png) | ![](/images/running.png) | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  | ![](/images/running.png)  |
| Performance                                                                                                                              |         â˜…â˜…â˜…â˜…â˜…          |           â˜…â˜…â˜…            |            â˜…â˜…             |           â˜…â˜…â˜…â˜…â˜…           |           â˜…â˜…â˜…â˜…â˜…           |            â˜…â˜…â˜…            |

ã“ã‚Œã¾ã§ã®è¡¨ã¨ã‚‚åˆã‚ã›ã¦è¦‹ã‚‹ã«ï¼Œ
**ä»–ã®Goãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«å®Ÿç¾ã§ãã¦ Iris ã«å®Ÿç¾ã§ããªã„ã“ã¨ã¯å…¨ãã¨è¨€ã£ã¦ã„ã„ã»ã©ç„¡ã•ãã†ã§ã™**

:::message
æ™®æ®µä½¿ç”¨ã—ãªãŒã‚‰ï¼Œç¢ºã‹ã«**Iris ã¯ä»–ã®Goãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚ˆã‚Šã‚‚é–‹ç™ºã—ã‚„ã™ã„ãƒ»æ–­ç„¶ãƒ»æ ¼æ®µã«MVCãƒ¢ãƒ‡ãƒ«ã‚’å½¢æˆã—ã‚„ã™ã„ã¨ã„ã†ã“ã¨ã¯å¼·ãæ„Ÿã˜ã¾ã™**  

å®Ÿéš›ã«ï¼ŒIris ã«ã¯ã€MVCãƒ¢ãƒ‡ãƒ«ã‚’å½¢æˆã™ã‚‹ãŸã‚ã ã‘ã®å°‚ç”¨æ©Ÿèƒ½ã€ãŒãŸãã•ã‚“å‚™ã‚ã£ã¦ã„ã¾ã™

ã“ã‚Œã«ã‚ˆã‚Šï¼Œã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å½¢æˆãªã©ã‚‚ã‚ˆã‚Šå®¹æ˜“ã«è¡Œãˆã¾ã™
:::

[â€» ãã®ä»–ã®æ¯”è¼ƒè©³ç´°](https://github.com/speedwheel/awesome-go-web-frameworks/blob/master/README.md)



# æº–å‚™

æ—©é€Ÿä½¿ã£ã¦ã„ãã¾ã—ã‚ˆã†

### 1. ã¾ãšï¼ŒGoãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã«ã¦ç¢ºèª

```go
$ go version
go version go1.17.6
```

### 2. Iris ã‚’getã—ã¦ã„ãã¾ã™ï¼

```go
// æ–°è¦ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆï¼ˆæ—¢å­˜ãƒ•ã‚©ãƒ«ãƒ€ã«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹éš›ã¯ä¸è¦ï¼‰
$ mkdir myapp 

// Iris ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã„ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•
$ cd myapp

// go mod åˆæœŸåŒ–
$ go mod init myapp

// Irisã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å–å¾—
$ go get github.com/kataras/iris/v12@master
// go ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒ 1.17 ä»¥é™
$ go install github.com/kataras/iris/v12@latest
```

[â€» å‚è€ƒã¯ã“ã¡ã‚‰](https://github.com/kataras/iris#-learning-iris)



# Iris ã®åŸºæœ¬ç·¨

Iris ã‚’ä½¿ã£ã¦ç°¡å˜ãªAPIã‚’ä½œæˆã—ã¦ã¿ã¾ã™ï¼ˆâ€» MVCã«ã—ãªã„å ´åˆï¼‰

```go:main.go
package main

import "github.com/kataras/iris/v12"

func main() {
    app := iris.New()

    app.Handle("GET", "/", func(ctx iris.Context) {
        ctx.JSON(iris.Map{"message": "ping"})
    })
	
    app.Listen(":8080")
}
```

`go run main.go` ã§ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¦ `localhost:8080` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã¿ã‚‹ã¨ï¼Œ
Jsonãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã® `{"message":"ping"}` ãŒè¿”ã‚Šã¾ã™

ã‚‚ã—ã‚‚ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ç­‰ã‚’ä½¿ã‚ãšã«ç´ ã®Goã§åŒã˜ã‚µãƒ¼ãƒãƒ¼ã‚’ä½œã‚‹å ´åˆï¼Œä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ ğŸ‘‡

```go:main.go
package main

import (
	"encoding/json"
	"net/http"
)

func main() {
    mux := http.NewServeMux()
    mux.HandleFunc("/", func(w http.ResponseWriter, q *http.Request) {
        message := map[string]string{
            "message": "ping",
        }
        jsonMessage, err := json.Marshal(message)
        if err != nil {
            panic(err.Error())
        }
        w.Write(jsonMessage)
    })
    http.ListenAndServe("127.0.0.1:8080", mux)
}
```

ã‚³ãƒ¼ãƒ‰ã®é‡ãŒã»ã¼å€ã«ãªã‚Šã¾ã—ãŸ...

ã“ã®ç†ç”±ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†

```go:iris/context/context.go
// Context is the midle-man server's "object" dealing with incoming requests.
//
// A New context is being acquired from a sync.Pool on each connection.
// The Context is the most important thing on the iris's http flow.
//
// Developers send responses to the client's request through a Context.
// Developers get request information from the client's request a Context.
type Context struct {
    // the http.ResponseWriter wrapped by custom writer.
    writer ResponseWriter
    // the original http.Request
    request *http.Request
    // the current route registered to this request path.
    currentRoute RouteReadOnly

    // the local key-value storage
    params RequestParams  // url named parameters.
    values memstore.Store // generic storage, middleware communication.
    query  url.Values     // GET url query temp cache, useful on many URLParamXXX calls.
    // the underline application app.
    app Application
    // the route's handlers
    handlers Handlers
    // the current position of the handler's chain
    currentHandlerIndex int
    // proceeded reports whether `Proceed` method
    // called before a `Next`. It is a flash field and it is set
    // to true on `Next` call when its called on the last handler in the chain.
    // Reports whether a `Next` is called,
    // even if the handler index remains the same (last handler).
    //
    // Also it's responsible to keep the old value of the last known handler index
    // before StopExecution. See ResumeExecution.
    proceeded int
    
    // if true, caller is responsible to release the context (put the context to the pool).
    manualRelease bool
}
```

ã¤ã¾ã‚Šï¼Œç´ ã®Goã§ `HandleFunc` ã‚’æ›¸ãéš›ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦å­˜åœ¨ã™ã‚‹ `http.ResponseWriter` ã‚„ `http.Request` ãŒï¼ŒIris ã® `Contextæ§‹é€ ä½“ï¼ˆstructï¼‰` ã®æ§‹æˆè¦ç´ ã¨ã—ã¦æ ¼ç´ã•ã‚Œã¦ã„ã¦ï¼Œãã‚ŒãŒé–¢æ•°ã®å†…éƒ¨ã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†ä»•çµ„ã¿ã§ã™

ã¡ãªã¿ã«ï¼Œ`app.Listen(":8080")` ã‚‚å®Ÿéš›ã«ã¯ `http.ListenAndServe(address, engine)` ãªã©ãŒä¸­èº«ã§å‘¼ã°ã‚Œã¦ã„ã¾ã™

å…ƒã€…ã®Goã®ã‚³ãƒ¼ãƒ‰ã‚’æ´»ã‹ã—ã¦ä¾¿åˆ©ãªå‡¦ç†ã‚’å®Ÿç¾ã—ã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ï¼


## ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ä½¿ç”¨

ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å¯¾ã™ã‚‹å‡¦ç†ã¯åŸºæœ¬ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

```
Request -> Route Parser -> Middleware -> Route Handler -> Middleware -> Response
```

ã¤ã¾ã‚Šï¼Œå®Ÿéš›ã«å‡¦ç†ã‚’è¡Œã†é–¢æ•°ã«åˆ°é”ã™ã‚‹å‰ã«å¿…ãšãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’é€šã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

ä¸Šè¨˜ã§ã®main.goã«åˆã‚ã›ã¦ä½¿ã†ã¨ã“ã‚“ãªæ„Ÿã˜ã§ã™ ğŸ‘‡
ãƒã‚¤ãƒ³ãƒˆã¯ï¼Œ**ã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¯å®Ÿè£…ã®å‰ã§ä½¿ç”¨ã™ã‚‹ã€** ã¨ã„ã†ã“ã¨ã§ã™

```go:main.go
package main

import (
    "net/http"

    "github.com/kataras/iris/v12"
)

func main() {
    app := iris.New()

    // ã“ã‚“ãªæ„Ÿã˜ã§
    // å®Ÿè£…ã®å‰ã®éƒ¨åˆ†ã§ä½¿ç”¨ï¼ï¼ï¼ï¼ï¼
    app.WrapRouter(routerWrapper)
    app.UseRouter(routerMiddleware)
    app.UseGlobal(globalMiddleware)
    app.Use(useMiddleware)
    app.UseError(errorMiddleware)
    app.Done(done)
    app.DoneGlobal(doneGlobal)

    app.Handle("GET", "/", func(ctx iris.Context) {
        ctx.JSON(iris.Map{"message": "ping"})
    })
    
    // ä»¥ä¸‹ æ§˜ã€…ãªå‡¦ç†ç­‰...

    app.Listen(":8080")
}
```

**Iris ã§ã¯ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒè±Šå¯Œã«ã‚ã‚Šï¼Œãã‚Œã‚‰ã‚’è¦šãˆãã‚‹ã®ã¯å¤§å¤‰ãªã®ã§...**

ã¾ãšã¯ã€Œãµã‚€ãµã‚€ã“ã‚“ãªæ„Ÿã˜ã§ä½¿ãˆã°ã„ã„ã‚“ã‚„ã­ã€œã€œã€ã¨è¦šãˆã¦ãŠã„ã¦ãã ã•ã„ï¼
ï¼ˆæ¥­å‹™ã§ä½¿ã†ã¨ãªã‚‹ã¨ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ä¸€ã¤ä¸€ã¤è¦šãˆã¦ã„ãå¿…è¦ã¯ï¼Œã‚„ã¯ã‚Šã‚ã‚Šã¾ã™ï¼‰


## HTMLã‚„é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹

### HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹

è¶…ç°¡å˜ã§ã™

 - `app.RegisterView()`
 
ã¨ã„ã† Iris ã®çµ„ã¿è¾¼ã¿é–¢æ•°ã‚’ä½¿ã„ï¼Œè¡¨ç¤ºç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ãã®ä¸­ã®ã©ã®ç¨®é¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.html` ãªã©ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¦ï¼Œã‚ã¨ã¯URLã«ã‚ˆã£ã¦è¡¨ç¤ºã—ãŸã„HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦ã„ãã ã‘ã§ã™

å®Ÿéš›ã«è¦‹ã¦ã¿ã¾ã—ã‚‡ã†

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯ä»¥ä¸‹ã®æƒ³å®šã§ã™ â€»

```
myapp
|- public
|- |- books
|- |- |- list.html
|- |- |- purchase.html
|- go.mod
|- main.go
```

ã‚³ãƒ¼ãƒ‰ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ ğŸ‘‡

```go:main.go
package main

import "github.com/kataras/iris/v12"

func main()  {
    app := iris.New()
    
    // "public" ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªé…ä¸‹ã® ".htmlãƒ•ã‚¡ã‚¤ãƒ«" ã‚’è¿”å´ã™ã‚‹ã‚ˆã†ã«è¨­å®š
    // ä¸Šæ›¸ãã•ã‚Œãƒã‚°ãŒæ½œã‚€å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚åŸºæœ¬çš„ã«ã¯ä¸€åº¦ã ã‘è¨­å®šã™ã‚‹ã‚ˆã†ã«ã—ï¼Œ
    // æŒ‡å®šã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆä»Šå›ã¯ "public"ï¼‰é…ä¸‹ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¢—ã‚„ã—ã¦ã„ãã‚ˆã†ã«ã™ã‚‹
    app.RegisterView(iris.HTML("/public", ".html"))
    
    // GET: "/"
    app.Get("/", func(ctx iris.Context) {
        // è¿”å´ã™ã‚‹viewãƒ•ã‚¡ã‚¤ãƒ«ã®æŒ‡å®šï¼ˆ"/public" ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã®ãƒ‘ã‚¹ï¼‰
        ctx.View("index.html")
    })

    // "/books/"ã‹ã‚‰å§‹ã¾ã‚‹URLã‚’å—ã‘å–ã£ãŸéš›ã®å‡¦ç†ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
    books := app.Party("/books")
    {
        // GET: "/books/"
        books.Get("/", func(ctx iris.Context) {
            // "/public" ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã®ãƒ‘ã‚¹ã§æŒ‡å®š
            ctx.View("/books/list.html")
        })
        // GET: "/books/buy"
        books.Get("/buy", func(ctx iris.Context) {
            // "/public" ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã®ãƒ‘ã‚¹ã§æŒ‡å®š
            ctx.View("/books/purchase.html")
        })
    }
    
    app.Listen(":8080")
}
```

ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¦ `localhost:8080` ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ï¼Œ`public/index.html` ã®å†…å®¹ãŒç¢ºèªã§ãã‚‹ã¯ãšã§ã™
`localhost:8080/books/buy` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‚ `public/books/index.html` ã®å†…å®¹ãŒç¢ºèªã§ãã‚‹ã¯ãšã§ã™ï¼

### é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹

ã“ã‚Œã‚‚ç°¡å˜ã§ã™

 - `app.HandleDir("å—ã‘å–ã‚‹URL", iris.Dir("è¡¨ç¤ºã—ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ç”»åƒãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¾ã§ã®ãƒ‘ã‚¹"))` 
 
ã¨æ›¸ãã ã‘ã§ã™

```go:main.go
package main

import "github.com/kataras/iris/v12"

func main()  {
    app := iris.New()
    
    // é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡¨ç¤º
    // "public" ãƒ•ã‚©ãƒ«ãƒ€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹
    app.HandleDir("/", iris.Dir("/public"))
    
    // ä»¥ä¸‹ æ§˜ã€…ãªå‡¦ç†ç­‰...
    
    app.Listen(":8080")
}
```

ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¦ `localhost:8080` ã‚’ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ `public` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã®ä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ï¼


## ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

Iris ã¨ã—ã¦ã¯
 - `ctx.SaveFormFile(ãƒ•ã‚¡ã‚¤ãƒ«, ä¿å­˜å…ˆã¾ã§ã®ãƒ‘ã‚¹)`

ã¨ã„ã£ãŸæ©Ÿèƒ½ãªã©ãŒå‚™ã‚ã£ã¦ã„ã¾ã™

ã‚³ãƒ¼ãƒ‰ã§è¦‹ãŸæ–¹ãŒæ—©ã„ã¨æ€ã„ã¾ã™ ğŸ‘‡

```go
const maxSize = 8 * iris.MB

func main() {
    app := iris.Default()

    app.Post("/upload", func(ctx iris.Context) {
        // ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ€å¤§å®¹é‡ã¯ã‚ã‚‰ã‹ã˜ã‚æ±ºã‚ã¦ãŠã„ã¦ã‚‚ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“
        ctx.SetMaxRequestBodySize(maxSize)
        // ğŸ‘† ã¯ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã§ã‚‚æŒ‡å®šã§ãã¾ã™
        // app.Use(iris.LimitRequestBodySize(maxSize))
        // ã¾ãŸã¯
        // iris.WithPostMaxMemory(maxSize) ãªã©ã‚‚

        file, fileHeader, err:= ctx.FormFile("file")
        if err != nil {
            ctx.StopWithError(iris.StatusBadRequest, err)
            return
        }
		    
        // ä¿å­˜å…ˆã‚’ä½œã£ã¦ãŠã
        // ã“ã“ã§ã¯ "destination" ã« "./public/ãƒ•ã‚¡ã‚¤ãƒ«å" ã¨ã„ã†ãƒ‘ã‚¹ãŒæ–‡å­—åˆ—ã§æ ¼ç´ã•ã‚Œã‚‹
        destination := filepath.Join("./public", fileHeader.Filename)
		
        // ä¿å­˜å‡¦ç†
        ctx.SaveFormFile(fileHeader, destination)
    })

    app.Listen(":8080")
}
```



## ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰ã‚¯ã‚¨ãƒª / ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆGet, Post, Put, Delete...ï¼‰

ã“ã¡ã‚‰ã‚‚ Iris ã«å‚™ãˆä»˜ãã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚Œã°ç°¡å˜ã§ã™

ã‚¯ã‚¨ãƒªå–å¾—
 - `ctx.ReadQuery()`
 - `ctx.URLParamInt()`

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
 - `ctx.Params().Get()`

ãªã©...

### ã‚¯ã‚¨ãƒªå–å¾—

```go:main.go
package main

import "github.com/kataras/iris/v12"

type MyType struct {
    // "url" ã‚¿ã‚°ã§ã‚¯ã‚¨ãƒªåã‚’æŒ‡å®šã—ã¦ã„ã¾ã™
    Name string `url:"name,required"`
    Age  int    `url:"age"`
}

func main()  {
    app := iris.New()
    
    // GET: "localhost:8080/users?name=tom&?age=19"
    // ãƒ‘ã‚¿ãƒ¼ãƒ³ 1.
    app.Handle("GET", "/users", func(ctx iris.Context) {
        var t MyType
        // ã‚¯ã‚¨ãƒªãŒã‚ã‚‹å ´åˆï¼Œiris.Context ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«å–å¾—ã§ãã¾ã™
        // ã“ã“ã§ã¯ã‚¯ã‚¨ãƒªã‹ã‚‰å—ã‘å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’æ§‹é€ ä½“ï¼ˆstructï¼‰ã«æ ¼ç´ã—ã¦ã„ã¾ã™
        err := ctx.ReadQuery(&t)
        
        //ã€Œtã€ã‚’ä½¿ã£ãŸæ§˜ã€…ãªå‡¦ç†ç­‰...
    })
    
    // ã‚‚ã¡ã‚ã‚“ãƒ¡ã‚½ãƒƒãƒ‰ã¸ã®åˆ‡ã‚Šå‡ºã—ã‚‚ã§ãã¾ã™
    app.Handle("GET", "/users", getUser)
    func getUser(ctx iris.Context) {
        // ä»¥ä¸‹ç•¥
    }
    
    
    // ãƒ‘ã‚¿ãƒ¼ãƒ³ 2.
    app.Handle("GET", "/users", func(ctx iris.Context) {
        // iris.Context ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚‚å–å¾—ã§ãã¾ã™
        // "name" ã¨è¨€ã†ã‚¯ã‚¨ãƒªã‚’å–å¾—ã—ï¼Œå¤‰æ•°ã«æ ¼ç´ã—ã¦ã„ã¾ã™
        name, err := c.Ctx.URLParamInt("name")  // name => "Tom"
        
        // ã€Œnameã€ã‚’ä½¿ã£ãŸæ§˜ã€…ãªå‡¦ç†ç­‰...
    })
    
    app.Listen(":8080")
}
```

### ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—

```go:main.go
package main

import "github.com/kataras/iris/v12"

func main()  {
    app := iris.New()
    
    // GET: "localhost:8080/users/123ï¼ˆIDãªã©ï¼‰"
    // ãƒ‘ã‚¿ãƒ¼ãƒ³ 1.
    app.Handle("GET", "/users/{id:int}", func(ctx iris.Context) {
        // iris.Context ã®æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã“ã®ã‚ˆã†ã«å–å¾—ã§ãã¾ã™
        id, _ := ctx.Params().Get("id")
        
        // ã€Œidã€ã‚’ä½¿ã£ãŸæ§˜ã€…ãªå‡¦ç†ç­‰...
    })
    
    // ã‚‚ã¡ã‚ã‚“ãƒ¡ã‚½ãƒƒãƒ‰ã¸ã®åˆ‡ã‚Šå‡ºã—ã‚‚ã§ãã¾ã™
    app.Handle("GET", "/users/{id:int}", getUser)
    func getUser(ctx iris.Context) {
        // ä»¥ä¸‹ç•¥
    }
    
    // ãƒ‘ã‚¿ãƒ¼ãƒ³ 2.
    app.Handlefunc("PUT", "/users/{id:int}", updateUser) 
    func updateUser(id int) response {
        // ã“ã†æ›¸ãã ã‘ã§ï¼Œã‚‚ã†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ã€Œidã€ãŒå¼•æ•°ã¨ã—ã¦å–å¾—ã§ãã¦ã„ã¾ã™
        // ã€Œidã€ã‚’ä½¿ã£ãŸæ§˜ã€…ãªå‡¦ç†ç­‰...
    })
}
```



# Iris ã§MVCãƒ¢ãƒ‡ãƒ«ã®ç°¡å˜ãªAPIã‚’ä½œã£ã¦ã¿ã‚ˆã†

## æœ€åˆã«èª¬æ˜

ä»Šå›ã¯ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã‚ˆã†ã¨æ€ã„ã¾ã™

### å®Ÿè£…æ©Ÿèƒ½

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®
 - æ–°è¦ä½œæˆ
   - POST: http://localhost:8080/users ï¼ˆâ€» jsonã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã«ã¦ãƒ‡ãƒ¼ã‚¿ã‚’é€ã‚‹ï¼‰
 - ä¸€è¦§å–å¾—
   - GET: http://localhost:8080/users/list
 - æ›´æ–°
   - PUT: http://localhost:8080/users/details/{id:uint}
 - å‰Šé™¤
   - DELETE: http://localhost:8080/users/details/{id:uint}

<br>
ã•ã¦ï¼ŒåŸºæœ¬ç·¨ã§ä½œæˆã—ãŸAPIã¯ï¼Œ`main.go` ã®ä¸­ã«ã‚ãã¾ã§**å—ã‘å–ã‚ŠãŸã„ãƒ‘ã‚¹ã‚„ãã®å¾Œã®å‡¦ç†ãªã©ã‚’â€ãƒ™ã‚¿æ›¸ãâ€ã—ãŸã‚‚ã®ã«éããšï¼ŒIris ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ´»ã‹ã—ãã‚Œã¦ã„ã‚‹ã¨ã¯è¨€ãˆã¾ã›ã‚“**

ä»Šå›ã¯ Iris ã®å¼·ã¿ã‚’æ´»ã‹ã—ã¦ï¼ŒMVCãƒ¢ãƒ‡ãƒ«ã‚’å½¢æˆã—ãªãŒã‚‰APIã‚’ä½œã£ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™


## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```
example-mvc-api
|- controller
|- |- users
|- |- |- users_controller.go
|- setups
|- |- configure_users_controllers.go  // DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ã‚’è¡Œã†éƒ¨åˆ†
|- model
|- |- user.go
|- service
|- |- user.go
|- |- init.go
|- go.mod
|- main.go
```

å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’getã—ã¾ã™ï¼ˆIris ã¯æ—¢ã«getã§ãã¦ã„ã‚‹æƒ³å®šï¼‰

ã¾ãŸï¼Œä»Šå›DBã¨ã®ã‚„ã‚Šã¨ã‚Šã‚’è¡Œã†ãŸã‚ã®ORMã«é–¢ã—ã¦ã¯ `gorp` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã¾ã™ âˆ’ [å…¬å¼ãƒªãƒã‚¸ãƒˆãƒª](https://github.com/go-gorp/gorp)

```go
$ go get github.com/go-sql-driver/mysql
$ go get github.com/go-gorp/gorp

// go 1.17 ä»¥é™
$ go install github.com/go-sql-driver/mysql@latest
$ go install github.com/go-gorp/gorp@latest
```

### main.go

```go:main.go
package main

import (
    "github.com/kataras/iris/v12"
    "github.com/kataras/iris/v12/middleware/accesslog"
    "github.com/kataras/iris/v12/middleware/recover"
    "github.com/kataras/iris/v12/mvc"
	
    "go-iris-sample/setups"
)

func main() {
    app := iris.New()

    // ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®ä½¿ç”¨
    app.Use(iris.Compression)
    app.Configure(iris.WithoutBodyConsumptionOnUnmarshal)
	
    // ãƒ­ã‚°è¨˜éŒ²ï¼ˆã“ã‚Œã‚‚å‚™ãˆä»˜ããƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼‰
    ac := accesslog.File("./access.log")
    defer ac.Close()
    app.UseRouter(ac.Handler)
    app.UseRouter(recover.New())

    // "/users/"ã‹ã‚‰å§‹ã¾ã‚‹URLã‚’å—ã‘å–ã£ãŸéš›ã®å‡¦ç†ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
    users := app.Party("/users")
    mvc.Configure(users, setups.ConfigureUsersControllers)

    // ãƒãƒ¼ãƒˆã®æŒ‡å®š
    app.Listen(":8080")
}
```

### setups/configure_users_controllers.goï¼ˆâ€» DI - ä¾å­˜æ€§æ³¨å…¥ ã‚’è¡Œã†ï¼‰

**Iris ã§MVCãƒ¢ãƒ‡ãƒ«ã‚’å½¢æˆã™ã‚‹ãŸã‚ã«ã¯ï¼Œ`main.go` ã§ä½œã£ãŸãƒ‘ã‚¹ã®ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆã‚’è¡¨ã™å¤‰æ•°ãªã©ï¼‰ã«å¯¾ã—ã¦ï¼Œä½¿ç”¨ã™ã‚‹ controller ãªã©ã‚’ DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ã‚’è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™**ãŒï¼Œä»Šå›ã¯ãã‚Œã‚’ã“ã® `setups` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§è¡Œãªã£ã¦ã„ã¾ã™ï¼ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®åå‰ã¯ä½•ã§ã‚‚å¤§ä¸ˆå¤«ã§ã™ï¼‰

å…·ä½“çš„ãªã¨ã“ã‚ã¯ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ãã ã•ã„

```go:setups/configure_users_controllers.go
import (
    "github.com/kataras/iris/v12/middleware/accesslog"
    "github.com/kataras/iris/v12/mvc"
    "go-iris-sample/controller/users"
)

// ConfigureUsersControllers
// main.go ã§å®šç¾©ã—ãŸURLã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¡¨ã™å¤‰æ•°ï¼ˆã“ã“ã§ã¯usersï¼‰ãŒå¼•æ•°ã«å…¥ã‚Šï¼Œ
// ãã‚Œã«å¯¾ã—ã¦DIï¼ˆä¾å­˜æ€§æ³¨å…¥ï¼‰ã‚’è¡Œã£ã¦ã„ã‚‹
func ConfigureUsersControllers(app *mvc.Application) {
    // ãƒ­ã‚°ã‚’å–å¾—ã—ã¦ãã‚Œã‚‹æ©Ÿèƒ½ã®DIã‚‚ã“ã“ã§è¡Œã†
    app.Register(accesslog.GetFields)
    
    // URLãŒ "/users" ã‹ã‚‰å§‹ã¾ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã£ãŸéš›ã«ï¼Œ
    // ä»¥ä¸‹ã® Controllerã‚’ä½¿ç”¨ã•ã›ã‚‹ã¨ã„ã†æŒ‡ç¤º
    app.Handle(new(users.UsersController))
}
```

### controller/users/users_controller.goï¼ˆâ€» ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆï¼ï¼ï¼ï¼ï¼‰

ã•ã¦ï¼Œ`main.go` ã§ `users` ã‹ã‚‰å§‹ã¾ã‚‹ãƒ‘ã‚¹ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ä½œã‚Šã¾ã—ãŸãŒï¼Œã“ã“ã§ä»Šå›ã®APIã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆå—ã‘å–ã‚‹URLï¼‰ã‚’å†ã³ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†
 - ~/users
 - ~/users/list
 - ~/users/details/{id:uint}
 - ~/users/details/{id:uint}

ã©ã‚Œã‚‚ `/users/` ã‹ã‚‰URLãŒå§‹ã¾ã‚Šã¾ã™ãŒï¼Œ`/users/list` ã‚„ `/users/details`... ãªã©ã®ã‚ˆã†ã«URLã¯åˆ†å²ã—ã¦ã„ã¾ã™

**ã“ã‚Œã‚’ã©ã†å®Ÿè£…ã—ã¾ã—ã‚‡ã†ï¼**

åŸºç¤ç·¨ã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã®ã‚ˆã†ã«ï¼Œ**ã¾ãŸä»–ã®Goãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯ãã†ã§ã™ãŒ....**
`app.Get("GET", "/users/list", ...)` ã¨ã„ã£ãŸå…·åˆã«ï¼Œãƒ¡ã‚½ãƒƒãƒ‰ã‚„ä¸€ã¤ä¸€ã¤ã®ãƒ‘ã‚¹ã‚’â€ãƒ™ã‚¿æ›¸ãâ€ã—ãŸã‚ˆã†ãªé–¢æ•°ã‚’ãŸãã•ã‚“ä½œã£ã¦ã„ãã®ã§ã¯å¤§å¤‰ã§ã™
ãã‚‚ãã‚‚ï¼Œã€Œé–¢æ•°ã€ã®ã“ã¨ã‚’ controller ã¨ã™ã‚‹ã®ã¯ç¾ã—ã„MVCå½¢æˆã¨è¨€ãˆã¾ã›ã‚“ï¼ˆæ©Ÿèƒ½ã®åˆ†å‰²ãªã©ãŒå›°é›£ã§å°å›ã‚ŠãŒåˆ©ã‹ãªã„ãƒ»ä¸€ã¤ã®é–¢æ•°ã«æ›¸ãé‡ãŒå¤šããªã£ã¦ã„ãã®ã¯ä¿å®ˆæ€§ãŒä½ã„ï¼‰ âŒ

ã¾ãŸï¼Œä¾‹ãˆã°Railsãªã©ä»–ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ã¤ã„ã¦ã¾ã¨ã‚ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ Iris ã§ã¯æ›¸ãã¾ã›ã‚“ âŒ

> ã‚‚ã£ã¨ã„ã„æ–¹æ³•ãŒã‚ã‚Šã¾ã™ï¼Iris ã«ã¯ã€MVCãƒ¢ãƒ‡ãƒ«ã‚’å½¢æˆã™ã‚‹ãŸã‚ã ã‘ã®æ©Ÿèƒ½ã€ãŒãŸãã•ã‚“ã‚ã‚‹ã®ã§ï¼Œãã¡ã‚‰ä½¿ã„ã¾ã—ã‚‡ã†

**æ­£è§£ã¯...**
**ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ï¼ˆcontrollerï¼‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®åå‰ã‚’å¤‰ãˆã‚‹ã€ã ã‘**
**ã§ã™ï¼** âœ…


ã“ã‚ŒãŒè¶…ä¾¿åˆ©ãªã‚“ã§ã™

å…·ä½“çš„ã«èª¬æ˜ã—ã¾ã™ï¼

ã¾ãšï¼Œ`main.go` ãªã©ã§URLã®ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã‚’ã—ã¾ã™ï¼ˆä»Šå›ã¯ `"~/users"` ï¼‰ï¼
ãã®ä¸Šã§ï¼Œä¾‹ãˆã° GET ã§ `/users/list` ã¨ã„ã†URLã‚’å—ã‘å–ã‚‹éš›ã®å‡¦ç†ã‚’è¡Œã†ã«ã¯ï¼Œé–¢é€£ã™ã‚‹ controllerã« `GetList()` ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ï¼Œ
POST ã§ `/users/details` ã¨ã„ã†URLã‚’å—ã‘å–ã‚‹éš›ã®å‡¦ç†ã‚’è¡Œã†ã«ã¯ï¼Œcontrollerã« `PostDetails()` ã¨ã„ã†ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œã‚Šãã®ä¸­ã«å‡¦ç†ã‚’æ›¸ã„ã¦ã„ã.....ï¼ˆâ€» ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚„ã‚¯ã‚¨ãƒªã«ã¤ã„ã¦ã¯ï¼Œãã“ã¾ã§ã¯æ›¸ã‹ãªãã¦å¤§ä¸ˆå¤«ã§ã™ï¼‰
ã¨ã„ã£ãŸå…·åˆã«ï¼Œ**å—ã‘å–ã‚‹æƒ³å®šã®URLã®ï¼Œ`app.Party()` ãªã©ã§æœ€åˆã«æŒ‡å®šã•ã‚ŒãŸéƒ¨åˆ†ï¼ˆã“ã“ã§ã¯ `users`ï¼‰ä»¥é™ã®éƒ¨åˆ†ã‚’ã‚­ãƒ£ãƒ¡ãƒ«ã‚±ãƒ¼ã‚¹ã§controllerã®ãƒ¡ã‚½ãƒƒãƒ‰ã®åå‰ã«ã™ã‚Œã°ï¼Œ** ãã‚Œã‚’ Iris ãŒè‡ªå‹•ã§åˆ¤åˆ¥ã—ã¦ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è‡ªå‹•ã§è¡Œãªã£ã¦ãã‚Œã‚‹ã®ã§ã™ï¼

ã¤ã¾ã‚Šã“ã®å ´åˆï¼Œ
 - GET ã§ `/users/list` ã¨ã„ã†URLã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒããŸå ´åˆï¼ŒIris ãŒè‡ªå‹•ã§ãã‚Œã‚’åˆ¤åˆ¥ã—ã¦controllerã® `GetList()` ã¨ã„ã†åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‡¦ç†ãŒè¡Œã‚ã‚Œã‚‹
 - POST ã§ `/users/details` ã¨ã„ã†URLã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒããŸå ´åˆï¼ŒIris ãŒè‡ªå‹•ã§ãã‚Œã‚’åˆ¤åˆ¥ã—ã¦controllerã® `PostDetails()` ã¨ã„ã†åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‡¦ç†ãŒè¡Œã‚ã‚Œã‚‹
 
ã¨ãªã‚Šã¾ã™
ï¼ˆâ€» `users := app.Party("/users")` ãªã©ã¨ã—ã¦URLã®ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ãƒ»DIã•ã‚Œã¦ã„ã‚‹å‰æï¼‰

ã§ã™ã®ã§ï¼Œä¾‹ãˆã°ä»Šå› GET ã§ `users/users/users/` ã¨ã„ã†URLã‚‚å—ã‘å–ã‚‹å ´åˆï¼Œcontrollerã« `GetUsersUsers()` ã¨ã„ã†åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒã‚ã‚Œã°ã‚‚ã¡ã‚ã‚“ãã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‡¦ç†ãŒè¡Œã‚ã‚Œã¾ã™

å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã† ğŸ‘‡
ã“ã“ã§ã®æ©Ÿèƒ½ã¨ã—ã¦ã¯ï¼Œä¸Šè¨˜ã®é€šã‚Šãƒªã‚¯ã‚¨ã‚¹ãƒˆæ¯ã« controller ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’åˆ¤åˆ¥ -> å‡¦ç†ã‚’ service ã«ãƒãƒ³ãƒ‰ãƒ« -> ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™ ã¨ãªã£ã¦ã„ã¾ã™
<br>

```go:controller/users/users_controller.go
package users

import (
    "github.com/kataras/iris/v12"
    "github.com/kataras/iris/v12/mvc"
    "go-iris-sample/model"
    "go-iris-sample/service"
)

type UsersController struct {
	UserService service.UserService
	Ctx         iris.Context
}

// ãƒ¡ã‚½ãƒƒãƒ‰åã§ãƒ‘ã‚¹ã®é•ã„ãƒ»ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å—ã‘ä»˜ã‘ã¾ã™ï¼ˆè¶…ä¾¿åˆ©ï¼‰
// [ä¾‹]
// GetList()                GET: "http://localhost:8080/users/list"
// Post()                   POST: "http://localhost:8080/users"
// PutDetails()             PUT: "http://localhost:8080/users/details"
// PutDetailsBy(id uint)    PUT: "http://localhost:8080/users/details/{id:int}"
// DeleteDetails()          DELETE: "http://localhost:8080/users/details"
// DeleteDetailsBy(id uint) DELETE: "http://localhost:8080/users/details/{id:int}"
// [ãã®ä»–ã®ä¾‹]
// POST: http://localhost:8080/users/details/example -> PostDetailsExample()
// PUT: http://localhost:8080/users -> Put()

func (c *UsersController) GetList() mvc.Response {
    // ä¸€è¦§å–å¾—
    users, err := c.UserService.GetUserList()
    if err != nil {
        return mvc.Response{
            Code: iris.StatusInternalServerError,  // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        }
    }
    
    // Iris ã«å‚™ãˆä»˜ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨æ§‹é€ ä½“ï¼ˆstructï¼‰
    return mvc.Response{
        Code:   iris.StatusOK,
        Object: users,
    }
}

func (c *UsersController) Post() mvc.Response {
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®jsonãƒ‡ãƒ¼ã‚¿ã‚’æ§‹é€ ä½“ï¼ˆstructï¼‰ã«æ ¼ç´ã™ã‚‹
    var user model.User
    err := c.Ctx.ReadJSON(&user)
    
    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆIris å‚™ãˆä»˜ãã®ã‚‚ã®ã§ä½œã‚Œã¾ã™ï¼‰
    if err != nil {
        c.Ctx.StopWithError(iris.StatusBadRequest, err)
        return mvc.Response{
            Code: iris.StatusBadRequest,
        }
    }
    
    // æ–°è¦ä½œæˆ
    err = c.UserService.CreateUser(&user)
    if err != nil {
        return mvc.Response{
            Code: iris.StatusInternalServerError,  // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        }
    }
    
    // Iris å‚™ãˆä»˜ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨æ§‹é€ ä½“ï¼ˆstructï¼‰
    return mvc.Response{ Code: iris.StatusCreated }
}

func (c *UsersController) PutDetailsBy(id int) mvc.Response {
    // ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã®jsonãƒ‡ãƒ¼ã‚¿ã‚’æ§‹é€ ä½“ï¼ˆstructï¼‰ã«æ ¼ç´ã™ã‚‹
    var user model.User
    err := c.Ctx.ReadJSON(&user)
    
    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆIris å‚™ãˆä»˜ãã®ã‚‚ã®ã§ä½œã‚Œã¾ã™ï¼‰
    if err != nil {
        c.Ctx.StopWithError(iris.StatusBadRequest, err)
        return mvc.Response{
            Code: iris.StatusBadRequest,
        }
    }
    
    user.Id = id
    
    // æ›´æ–°
    err = userService.UpdateUser(&user)
    if err != nil {
        return mvc.Response{
            Code: iris.StatusInternalServerError,  // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        }
    }
    
    // Iris å‚™ãˆä»˜ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨æ§‹é€ ä½“ï¼ˆstructï¼‰
    return mvc.Response{ Code: iris.StatusOK }
}

func (c *UsersController) DeleteDetailsBy(id int) mvc.Response {
    // å‰Šé™¤
    err := c.UserService.DeleteUser(id)
    if err != nil {
        return mvc.Response{
            Code: iris.StatusInternalServerError,  // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        }
    }
    
    // Iris å‚™ãˆä»˜ãã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨æ§‹é€ ä½“ï¼ˆstructï¼‰
    return mvc.Response{ Code: iris.StatusOK }
}
```

:::message
ã“ã“ã§ controller å†…ã® `PutDetailsBy(id int)`ï¼Œ`DeleteDetailsBy(id int)` ã«ã”æ³¨ç›®ãã ã•ã„
ä»Šå›ã®å®Ÿè£…ã§ã¯URLã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ `id` ãŒé€ã‚‰ã‚Œã¦ãã‚‹ã®ã§ã™ãŒ...
ï¼ˆ/users/details/{id} ãªã©ï¼‰
<br>
**ç‰¹ã«ä½•ã‚‚ã—ãªãã¦ã‚‚ï¼Œãƒ¡ã‚½ãƒƒãƒ‰åã®çµ‚ã‚ã‚Šã«ã€ŒByã€ã‚’ä»˜ã‘ã¦ãŠãã ã‘ã§è‡ªå‹•ã§ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã®å¼•æ•°ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã®å€¤ãŒå…¥ã‚Šã¾ã™ï¼ï¼ˆã‚‚ã¡ã‚ã‚“ãã®å€¤ã¯ä½¿ãˆã¾ã™ï¼‰**
<br>
ä¾¿åˆ©...
:::

### model/user.go

Useræ§‹é€ ä½“ï¼ˆstructï¼‰ã‚’å®šç¾©ã—ã¦ã„ã¾ã™
`db`ã‚¿ã‚°ã‚’ã¤ã‘ã¦ãŠãã“ã¨ã§ï¼ŒORMã‚’ä½¿ã£ã¦DBã¨ã‚„ã‚Šã¨ã‚Šã§ãã¾ã™

```go:model/user.go
package model

type User struct {
    Id    string  `json:"id"   db:"id"`
    Name  string  `json:"name" db:"name"`
    Age   uint32  `json:"age"  db:"age"`
}
```

### service/init.go

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã®åˆæœŸåŒ–ã‚’å®Ÿè£…ã—ã¾ã™

```go:service/init.go
package service

import (
    "database/sql"
    "fmt"
    "github.com/go-gorp/gorp"
    "go-iris-sample/model"
    "log"
    "os"
    
    _ "github.com/go-sql-driver/mysql"
)

// gorpåˆæœŸåŒ–å‡¦ç†
func InitDb() *gorp.DbMap {
    dbUserName := "DB_USERNAME"
    dbPassWord := "DB_PASSWORD"
    dbHost := "DB_HOST"
    dbPort := "DB_PORT"
    dbDbName := "DB_DBNAME"
    db, err := sql.Open("mysql", fmt.Sprintf("%v:%v@tcp(%v:%v)/%v?parseTime=true", dbUserName, dbPassWord, dbHost, dbPort, dbDbName))
    if err != nil {
        fmt.Printf("error! can't open sql driver %v", err)
    }
    dbmap := &gorp.DbMap{Db: db, Dialect: gorp.MySQLDialect{"InnoDB", "UTF8"}}
    
   // ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
    dbmap.AddTableWithName(model.User{}, "user").SetKeys(true, "Id")
    err = dbmap.CreateTablesIfNotExists()
    if err != nil {
        fmt.Printf("error! can't craete table: %v", err)
    }
    
    // ãƒ­ã‚°ã®å–å¾—
    dbmap.TraceOn("[gorp]", log.New(os.Stdout, "go-iris-sample:", log.Lmicroseconds))
    
    return dbmap
}
```

### service/user.go

å®Ÿè£…ã®éƒ¨åˆ†ã§ã™
ã“ã“ã§ã¯ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‹ã‚‰ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã•ã‚ŒãŸä»¥ä¸‹ã®å‡¦ç†ã‚’è¡Œã„ã¾ã™
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®
 - ##### ä¸€è¦§å–å¾—
 - ##### æ–°è¦ä½œæˆ
 - ##### æ›´æ–°
 - ##### å‰Šé™¤

ã‚’è¡Œã£ã¦ã„ã¾ã™

```go:service/user.go
package service

import (
    "go-iris-sample/_example-mvc-api/model"
    
    _ "github.com/go-sql-driver/mysql"
)

type UserService struct {}

func (UserService) GetUserList() ([]model.User, error) {
    // initialize the DbMap
    dbMap := InitDb()
    defer dbMap.Db.Close()
    
    var users []model.User
    
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å…¨å–å¾—
    _, err := dbMap.Select(&users, `SELECT * FROM users`)
    if err != nil {
        return []model.User{}, err
    }
    
    return users, nil
}

func (UserService) CreateUser(user *model.User) error {
    // initialize the DbMap
    dbMap := InitDb()
    defer dbMap.Db.Close()
    
    // ãƒˆãƒ©ãƒ³ ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’èµ°ã‚‰ã›ãªãŒã‚‰insert
    tx, _ := dbMap.Begin()
    
    err := tx.Insert(user)
    if err != nil {
        tx.Rollback()
        return err
    }
    
    tx.Commit()
    
    return nil
}

func (UserService) UpdateUser(user *model.User) error {
    // initialize the DbMap
    dbMap := InitDb()
    defer dbMap.Db.Close()
    
    // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’èµ°ã‚‰ã›ãªãŒã‚‰update
    tx, _ := dbMap.Begin()
    
    _, err := tx.Update(user)
    if err != nil {
        tx.Rollback()
        return err
    }
    
    tx.Commit()
    
    return nil
}

func (UserService) DeleteUser(id int) error {
    // initialize the DbMap
    dbMap := InitDb()
    defer dbMap.Db.Close()
    
    // id ã‹ã‚‰å‰Šé™¤ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—
    var user model.User
    err := dbMap.SelectOne(&user, `SELECT * FROM users WHERE id = :id`,
        map[string]interface{}{
            "id": id,
        })
    if err != nil {
        fmt.Printf("error! can't find user by id: %v.\n", id)
        return err
    }
    
    // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’èµ°ã‚‰ã›ãªãŒã‚‰delete
    tx, _ := dbMap.Begin()
    
    _, err := tx.Delete(&user)
    if err != nil {
        tx.Rollback()
        return err
    }
    
    tx.Commit()
    
    return nil
}
```

ã“ã‚“ãªæ„Ÿã˜ã§ï¼ŒIris ã‚’ä½¿ã£ã¦APIã‚’ä½œã‚Œã¾ã™

> `go run main.go` ã§ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¦ï¼Œãã‚Œãã‚Œã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…å®¹ã‚’æ­£ã—ã„å†…å®¹ã«ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã—ï¼Œæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„

ã¾ãŸï¼Œä»¥ä¸‹ã¯ä¾‹ã§ã™ãŒï¼Œèµ·å‹•å¾ŒURLã¸ã‚¢ã‚¯ã‚»ã‚¹ã‚’ã™ã‚‹ã¨ã“ã‚“ãªæ„Ÿã˜ã®ãƒ­ã‚°ã‚‚ç¢ºèªã§ãã‚‹ã¯ãšã‹ã¨æ€ã„ã¾ã™

```shell:access.log
2022-04-17 19:08:16|1.19426ms|200|GET|/|::1|0 B|10 B||
2022-04-17 19:08:16|42.803Âµs|404|GET|/favicon.ico|::1|0 B|0 B||
2022-04-17 19:08:21|27.538Âµs|404|GET|/favicon.ico|::1|0 B|0 B||
2022-04-17 19:09:36|112.584Âµs|404|GET|/favicon.ico|::1|0 B|0 B||
2022-04-17 19:09:40|32.466Âµs|404|GET|/favicon.ico|::1|0 B|0 B||
2022-04-17 19:09:44|180.006Âµs|200|GET|/|::1|0 B|10 B||
2022-04-17 19:09:44|25.901Âµs|404|GET|/favicon.ico|::1|0 B|0 B||
2022-04-17 19:09:58|168.375Âµs|200|GET|/users|::1|0 B|10 B||
2022-04-17 19:09:58|29.095Âµs|404|GET|/favicon.ico|::1|0 B|0 B||
2022-04-17 19:10:47|322.583Âµs|200|GET|/users|127.0.0.1|64 B|10 B|{"firstname":"Tanaka","lastname":"ryo","age":15}|
```
<br>
é•·ããªã£ã¦ã—ã¾ã„ã¾ã—ãŸãŒï¼Œä»¥ä¸Šã«ãªã‚Šã¾ã™ï¼



# çµ‚ã‚ã‚Šã«
ã“ã‚Œã¾ã§ã‚‚è¿°ã¹ã¦ããŸã‚ˆã†ã«ï¼ŒIris ã¯Goè¨€èªã®ã¤ã‚ˆã¤ã‚ˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™
ãœã²ä¸€åº¦ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼



# å‚è€ƒè¨˜äº‹
å¤§æ„Ÿè¬ã§ã™ ğŸ™‡ğŸ¼â€â™‚ï¸


https://qiita.com/Syoitu/items/8e7e3215fb7ac9dabc3a#%E6%A7%8B%E9%80%A0%E4%BD%93%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F%E3%83%90%E3%83%AA%E3%83%87%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3



[^1]: æ›¸ãæ–¹ã«ã‚ˆã£ã¦ã¯ï¼Œã€Œcontroller ã®ã‚ˆã†ãªã‚‚ã®ã€ã¯ä½œã‚Œã¾ã™ï¼ãŒï¼Œã‚‚ã£ã¨ã„ã„æ–¹æ³•ãŒã‚ã‚Šã¾ã£ã›ã€œï¼ã¦è©±ã§ã™